#This code take two file first,A and second,B containing IPs line by line
#And give A-B, AuB, A intersection B etc.
#
import sys;
def fileLineToList(fname):
    with open(fname) as f:
        contents = [x.strip() for x in f.readlines()]
    return sorted(list(set(contents)));

f=sys.argv[1];
s=sys.argv[2];
fl= fileLineToList(f);
sl= fileLineToList(s);



patched=list(set(fl)-set(sl));
print "Patched \t Size: "+str(len(patched));
for x in patched:
    print x;

print ""

newlyVuln=list(set(sl)-set(fl));
print "New Vulnerables \t Size: "+str(len(newlyVuln));
for x in newlyVuln:
    print x;

print ""

unPatched=list(set(fl)-set(patched));
print "UnPatched \t Size: "+str(len(unPatched));
for x in unPatched:
    print x;

print ""

print "Previously Vulnerable:"+str(len(fl));
print "Now Vulnerable:"+str(len(sl));
print "Patched:"+str(len(list(set(fl)-set(sl))));
print "Unpatched:"+str(len(set(fl)-set(patched)))
